<section class="bread-crumb mb-3 mt-2">
	<span class="crumb-border"></span>
	<div class="container">
		<div class="row">
			<div class="col-12 a-left">
				<ul class="breadcrumb m-0 px-0">					
					<li>
						<a href="/" target="_self"><span>Trang chủ</span></a>
						<span class="mr_lr">&nbsp;/&nbsp;</span>		
					</li>
					
					<li class="active">
						<span>Giỏ hàng (
						<?php
							if($this->session->userdata('cart')){
								$val = $this->session->userdata('cart');
								echo count($val);
							}else{
								echo 0;
							}
						?>
							)</span>
					</li>
					
				</ul>
			</div>
		</div>
	</div>
</section>

<div class="cart-coupon my-4">
	<div class="cart-coupon-header">
		<span class="coupon-toggle-btn">
			<i class="fa fa-arrow-left "> </i>
		</span>
		<span>Mã giảm giá</span>
	</div>
	<link rel="preload" as="style" type="text/css" href="//theme.hstatic.net/200000458129/1000869299/14/coupon.css?v=59">

<link rel="stylesheet" href="//theme.hstatic.net/200000458129/1000869299/14/coupon.css?v=59">
<!-- ℹ-->

<div class="section_coupons">
	<div class="container border-0">
		<div class="row scroll justify-content-xl-center">
			


<div class="py-2 col-12">
	<div class="coupon_item">
	
	<div class="coupon_icon pos-relative embed-responsive embed-responsive-1by1">
				<img class="img-fluid" src="//theme.hstatic.net/200000458129/1000869299/14/coupon_1_img.png?v=59" alt="coupon_1_img.png" width="79" height="70">
			</div>
		<div class="coupon_body">
		<div class="coupon_head">
			<h3 class="coupon_title">NHẬP MÃ: EGA50</h3>
			<div class="coupon_desc">Giảm 50% cho đơn hàng giá trị tối thiểu 500K. Mã giảm tối đa 300K			</div>

		</div>
		<div class="d-flex align-items-center flex-wrap justify-content-between">
			<button class="btn btn-main btn-sm coupon_copy" data-ega-coupon="EGA10">
				<span>Sao chép</span></button>
						<span class="coupon_info_toggle" data-coupon="EGA10">
				Điều kiện
			</span>
			<div class="coupon_info">
				- Giá trị đơn hàng tối thiểu 250k. <br>
- Mỗi khách hàng được sử dụng tối đa 1 lần.			</div>
			
		</div>
	</div>
</div></div>



<div class="py-2 col-12">
	<div class="coupon_item">
	
	<div class="coupon_icon pos-relative embed-responsive embed-responsive-1by1">
				<img class="img-fluid" src="//theme.hstatic.net/200000458129/1000869299/14/coupon_2_img.png?v=59" alt="coupon_2_img.png" width="79" height="70">
			</div>
		<div class="coupon_body">
		<div class="coupon_head">
			<h3 class="coupon_title">NHẬP MÃ: EGA15</h3>
			<div class="coupon_desc">Giảm 15% cho đơn hàng giá trị tối thiểu 500k. Mã giảm tối đa 250K			</div>

		</div>
		<div class="d-flex align-items-center flex-wrap justify-content-between">
			<button class="btn btn-main btn-sm coupon_copy" data-ega-coupon="EGA15">
				<span>Sao chép</span></button>
						<span class="coupon_info_toggle" data-coupon="EGA15">
				Điều kiện
			</span>
			<div class="coupon_info">
				- Đơn hàng giá trị tối thiểu 500k. <br>
- Chỉ áp dụng 1 mã giảm giá trên một đơn hàng.			</div>
			
		</div>
	</div>
</div></div>



<div class="py-2 col-12">
	<div class="coupon_item">
	
	<div class="coupon_icon pos-relative embed-responsive embed-responsive-1by1">
				<img class="img-fluid" src="//theme.hstatic.net/200000458129/1000869299/14/coupon_3_img.png?v=59" alt="coupon_3_img.png" width="79" height="70">
			</div>
		<div class="coupon_body">
		<div class="coupon_head">
			<h3 class="coupon_title">NHẬP MÃ: EGA99K</h3>
			<div class="coupon_desc">Mã giảm 99k cho đơn hàng tối thiểu 1 triệu. Tối đa 1 mã giảm giá/đơn hàng.			</div>

		</div>
		<div class="d-flex align-items-center flex-wrap justify-content-between">
			<button class="btn btn-main btn-sm coupon_copy" data-ega-coupon="EGA99K">
				<span>Sao chép</span></button>
						<span class="coupon_info_toggle" data-coupon="EGA99K">
				Điều kiện
			</span>
			<div class="coupon_info">
				- Đơn hàng từ 1000K.<br>
- Chỉ áp dụng 1 mã giảm giá trên một đơn hàng.			</div>
			
		</div>
	</div>
</div></div>



<div class="py-2 col-12">
	<div class="coupon_item">
	
	<div class="coupon_icon pos-relative embed-responsive embed-responsive-1by1">
				<img class="img-fluid" src="//theme.hstatic.net/200000458129/1000869299/14/coupon_4_img.png?v=59" alt="coupon_4_img.png" width="79" height="70">
			</div>
		<div class="coupon_body">
		<div class="coupon_head">
			<h3 class="coupon_title">NHẬP MÃ:  FREESHIP</h3>
			<div class="coupon_desc">Miễn phí vận chuyển cho đơn hàng từ 500k. Áp dụng cho khu vực Tp.HCM			</div>

		</div>
		<div class="d-flex align-items-center flex-wrap justify-content-between">
			<button class="btn btn-main btn-sm coupon_copy" data-ega-coupon="FREESHIP">
				<span>Sao chép</span></button>
						<span class="coupon_info_toggle" data-coupon="FREESHIP">
				Điều kiện
			</span>
			<div class="coupon_info">
				- Đơn hàng từ 500K <br>
- Áp dụng cho khu vực Tp.HCM			</div>
			
		</div>
	</div>
</div></div>

		</div>
	</div>
</div>
<script type="text/x-custom-template" data-template="couponPopup">
<div id="coupon-modal" class="coupon-modal modal fade " role="dialog" style="display:none;">
	<div class="modal-dialog align-vertical">
    <div class="modal-content">
		<button type="button" class="close window-close" data-dismiss="modal" data-backdrop="false"
        aria-label="Close" style="z-index: 9;"><span aria-hidden="true">×</span></button>
		<div class="coupon-content"></div>
	</div>
	</div>
	</div>
</script>
<script>
$(document).ready(()=>{
		let initCoupon = false
		function initCoupons (){
		if( initCoupon) return
		initCoupon = true
		if(!$('#coupon-modal').length){
		$('body').append($('[data-template="couponPopup"]').html())
		}
		$('.coupon_info_toggle').click(function(e){
				e.preventDefault();
				const code = $(this).data('coupon')
				const info = $(this).next('.coupon_info').html()|| ''
				const title = $(this).parents('.coupon_body').find('.coupon_title').text() || ''
				const couponHtml = `
					<div class="coupon-title">${title}</div>
					<div class="coupon-row">
						<div class="coupon-label">Mã khuyến mãi:</div><span class="code">${code}</span>
	
					</div>
					<div class="coupon-row">
						<div class="coupon-label">Điều kiện:</div><div class="coupon-info">${info}</div>
					</div>
					<div class="coupon-action">
					<button type="button" class="btn btn-main" data-dismiss="modal" data-backdrop="false"
        				aria-label="Close" style="z-index: 9;">Đóng</button>
					<button class="btn btn-main coupon_copy" data-ega-coupon="${code}">
						<span>Sao chép</span></button>
					</div>
					`
				$('.coupon-modal .coupon-content').html(couponHtml)
				$("#coupon-modal").modal();
			})
			$(document).on('click','.coupon_copy', function() {
				
		const copyText = "Sao chép";
		const copiedText = "Đã chép";
		const coupon = $(this).data().egaCoupon;
		const _this = $(this);
		_this.html(`<span>${copiedText}</span>`);
		_this.addClass('disabled');
		setTimeout(function() {
			_this.html(`<span>${copyText}</span>`);
			_this.removeClass('disabled');
		}, 3000)
		navigator.clipboard.writeText(coupon);
	})
		
		}
	$(window).one(' mousemove touchstart scroll', initCoupons)
			
	})
</script>	<div class="cart-coupon-footer ">
		<button class="btn btn-main btn-block rounded-sm coupon-toggle-btn">
			Quay lại trang giỏ hàng
		</button>
	</div>
</div>
<?php if($this->session->userdata('cart')):
			$cart = $this->session->userdata('cart');?>

<div class="cart-coupon-overlay coupon-toggle-btn"></div>
<div id="tab-header"></div>
<section class="main-cart-page main-container col1-layout mobile-tab active" id="cart-tab" data-title="Giỏ hàng">
	<div class="wrap_background_aside padding-top-15 margin-bottom-40 padding-left-0 padding-right-0 cartmbstyle">
		<div class="cart-mobile container card border-0 py-2">
			<form action="/cart" method="post" novalidate="" class="margin-bottom-0">
				<div class="header-cart">
				<div class=" title_cart_mobile heading-bar">
						<h1 class="heading-bar__title">Giỏ hàng</h1>
					</div>
				</div>

	<?php foreach ($cart as $key => $value) : 
			$row = $this->Mproduct->product_detail_id($key);?>					
				<div class="header-cart-content">
					<div class="cart_page_mobile content-product-list">
	  <div class="item-product item productid-1082488495 ">
		<div class="text-center">
			<a class="remove-itemx remove-item-cart " title="Xóa" href="javascript:;"  onclick="onRemoveProduct(<?php echo $row['id']; ?>)" data-id="1082488495">
				<svg class="icon" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
					<g clip-path="url(#clip0)">
					<path d="M0.620965 12C0.462896 12 0.304826 11.9399 0.184729 11.8189C-0.0563681 11.5778 -0.0563681 11.1869 0.184729 10.9458L10.9497 0.180823C11.1908 -0.0602744 11.5817 -0.0602744 11.8228 0.180823C12.0639 0.421921 12.0639 0.8128 11.8228 1.05405L1.05795 11.8189C0.936954 11.9392 0.778884 12 0.620965 12Z" fill="#8C9196"></path>
					<path d="M11.3867 12C11.2287 12 11.0707 11.9399 10.9505 11.8189L0.184729 1.05405C-0.0563681 0.8128 -0.0563681 0.421921 0.184729 0.180823C0.425827 -0.0602744 0.816706 -0.0602744 1.05795 0.180823L11.8228 10.9458C12.0639 11.1869 12.0639 11.5778 11.8228 11.8189C11.7018 11.9392 11.5439 12 11.3867 12Z" fill="#8C9196"></path>
					</g>
					<defs>
					<clipPath id="clip0">
					<rect width="12" height="12" fill="white"></rect>
					</clipPath>
					</defs>
				</svg>
			</a>
		</div>


		<div class="item-product-cart-mobile">
			<a href="<?php echo $row['alias'] ?>">	
				</a><a class="product-images1  pos-relative embed-responsive embed-responsive-1by1" href="" title="<?php echo $row['name'] ?>">
					<img class="img-fluid" src="public/images/products/<?php echo $row['avatar'] ?>" alt="<?php echo $row['alias'] ?>">
				</a>
			
		</div>
		<div class="product-cart-infor">
		<div class="title-product-cart-mobile">
			<h3 class="product-name"> 
				<a class="text2line" href="<?php echo $row['alias'] ?>" title="<?php echo $row['alias'] ?>">
					<?php echo $row['name'] ?>
				</a>  
			</h3>
			
		</div>
		
		<div class="cart-price">
			<span class="product-price price">
			<?php 
				if($row['price_sale'] > 0){
					echo (number_format($row['price_sale'])).'₫';
				}else{
					echo (number_format($row['price'])).'₫';
				}
			?>
			</span>
		</div>
		<!-- <div class="select-item-qty-mobile">
			<div class="txt_center">
				<input class="variantID" type="hidden" name="variantId" value="1082488495">

				<button onclick="var result = document.getElementById('qtyMobile1082488495'); var qtyMobile1082488495 = result.value; if( !isNaN( qtyMobile1082488495 ) &amp;&amp; qtyMobile1082488495 > 1 ) result.value--;return false;" class="reduced items-count btn-minus btn" type="button">
					<svg class="icon">
						<use xlink:href="#icon-minus"></use>
					</svg>
				</button>

				<input type="text" maxlength="3" min="1" class="form-control input-text number-sidebar qtyMobile1082488495" id="qtyMobile1082488495" name="Lines" size="4" value="2">
				
				<button onclick="var result = document.getElementById('qtyMobile1082488495'); var qtyMobile1082488495 = result.value; if( !isNaN( qtyMobile1082488495 )) result.value++;return false;" class="increase items-count btn-plus btn" type="button">
					<svg class="icon">
						<use xlink:href="#icon-plus"></use>
					</svg>
				</button>

			</div>
		</div> -->
		</div>
	  </div>
				
			
	</div>

	  <div class="header-cart-price">
	  	<div class="timedeli-modal">
		  <div class="timedeli-modal-content">
    		<button type="button" class="close window-close d-sm-none" aria-label="Close" style="z-index: 9;"><span aria-hidden="true">×</span></button>
    		<div class="timedeli-cta">
	    		<button class="btn btn-block timedeli-btn  d-sm-none" type="button">
				  <span>Xong</span>
    		    </button>		
	    	</div>
		  </div>
		  <div class="timedeli-overaly">
		</div>
	  </div>
	  <?php endforeach; ?>
	  

	  <?php $total = 0; ?>
						<?php foreach ($cart as $key => $value) : 
							$row = $this->Mproduct->product_detail_id($key);?>
							<?php
								if($row['price_sale'] > 0)
									$sum = $row['price_sale'] * $value;
								else
									$sum = $row['price'] * $value;
								$total += $sum;
							?>	
						<?php endforeach; ?>

		<div class="title-cart d-none d-sm-flex ">
			<h3 class="text-xs-left">TỔNG CỘNG</h3>
			<span class="text-xs-right  totals_price_mobile"><?php echo (number_format($total)).'₫'; ?></span>
			<!-- <i class="text-xs-right price_vat ">(Đã bao gồm VAT nếu có)</i>		 -->
		</div>
		
  			<div class="cart-limit-alert d-xs-none" style="display: none;">
					<i class="fa fa-info-circle mr-1" aria-hidden="true"></i> 
					Đơn hàng của bạn chưa đạt giá trị tối thiểu 500.000đ. Vui lòng chọn mua thêm sản phẩm.
		    </div>

		<?php else: ?>
			<p id = "cart-info">Không có sản phẩm nào trong giỏ hàng !</p>
			<a onclick="window.history.go(-1);" class="fa fa-undo undo">Tiếp tục mua hàng</a>
		<?php endif;?>

		<div class="checkout d-none d-sm-block">
			<button class="btn btn-block btn-proceed-checkout-mobile" title="Tiến hành thanh toán" type="button" onclick="window.location.href='checkout'">
				<span>Thanh Toán</span>
		    </button>		
		</div>
				
		<div class="cart-trustbadge mt-3">
			<span class="title-menu">
	Phương thức thanh toán 
</span>
<div class="trustbadge">
	<a href="/" target="_blank" title="Phương thức thanh toán">
		<img class=" img-fluid" src="//theme.hstatic.net/200000458129/1000869299/14/footer_trustbadge.jpg?v=59" alt="" width="246" height="53">
	</a>
</div>
		</div>
			  </div>
	
	</div>
			</form>
		</div>
		<div class="cart-empty container card border-0 py-2 " style="display:none">
			<div class="alert green-alert section" role="alert">
				<div class="title-cart text-center">
					<h1 class="d-none">Giỏ hàng</h1>
					<div>
						<img src="//theme.hstatic.net/200000458129/1000869299/14/cart_empty_background.png?v=59" class="img-fluid" width="298" height="152">
					</div>
					<h3>
						Hổng” có gì trong giỏ hết
					</h3>
					<p>	Về trang cửa hàng để chọn mua sản phẩm bạn nhé!!</p>
					<a href="/" title="Mua sắm ngay" class="btn btn-main">Mua sắm ngay</a> 
				</div>
			</div>
		</div>
	</div>
</section>